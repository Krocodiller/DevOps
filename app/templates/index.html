<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤ - –°–∏—Å—Ç–µ–º–∞ –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè• –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –ö–æ–æ–ø–µ—Ä–∞—Ç–∏–≤</h1>
            <p>–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ü–∏–µ–Ω—Ç–∞–º–∏, –≤—Ä–∞—á–∞–º–∏ –∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–º–∏ –∑–∞–ø–∏—Å—è–º–∏</p>
            {% if user %}
            <div class="user-info">
                <span class="user-name">üë§ {{ user.name }}</span>
                <span class="user-role">{{ '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' if user.role == 'admin' else '–í—Ä–∞—á' }}</span>
                <a href="/logout" class="logout-btn">–í—ã–π—Ç–∏</a>
            </div>
            {% endif %}
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('patients')">üë• –ü–∞—Ü–∏–µ–Ω—Ç—ã</button>
            {% if user and user.role == 'admin' %}
            <button class="nav-tab" onclick="showTab('doctors')">üë®‚Äç‚öïÔ∏è –í—Ä–∞—á–∏</button>
            {% endif %}
            <button class="nav-tab" onclick="showTab('medicines')">üíä –õ–µ–∫–∞—Ä—Å—Ç–≤–∞</button>
            <button class="nav-tab" onclick="showTab('visits')">üìã –í–∏–∑–∏—Ç—ã</button>
            <button class="nav-tab" onclick="showTab('analytics')">üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</button>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ -->
        <div id="patients" class="tab-content active">
            <h2>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ü–∞—Ü–∏–µ–Ω—Ç–∞–º–∏</h2>
            
            <div class="grid">
                <div class="card">
                    <h3>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –ø–∞—Ü–∏–µ–Ω—Ç–∞</h3>
                    <form id="patientForm">
                        <div class="form-group">
                            <label for="patientName">–ò–º—è –ø–∞—Ü–∏–µ–Ω—Ç–∞:</label>
                            <input type="text" id="patientName" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="patientGender">–ü–æ–ª:</label>
                            <select id="patientGender" class="form-control" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª</option>
                                <option value="–ú—É–∂—Å–∫–æ–π">–ú—É–∂—Å–∫–æ–π</option>
                                <option value="–ñ–µ–Ω—Å–∫–∏–π">–ñ–µ–Ω—Å–∫–∏–π</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="patientBirthDate">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</label>
                            <input type="date" id="patientBirthDate" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="patientAddress">–î–æ–º–∞—à–Ω–∏–π –∞–¥—Ä–µ—Å:</label>
                            <textarea id="patientAddress" class="form-control" rows="3" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞</button>
                    </form>
                </div>

                <div class="card">
                    <h3>–°–ø–∏—Å–æ–∫ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤</h3>
                    <div id="patientsList">
                        <div class="loading">
                            <div class="spinner"></div>
                            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å –≤—Ä–∞—á–µ–π (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤) -->
        {% if user and user.role == 'admin' %}
        <div id="doctors" class="tab-content">
            <h2>üë®‚Äç‚öïÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –í—Ä–∞—á–∞–º–∏</h2>
            
            <div class="grid">
                <div class="card">
                    <h3>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –≤—Ä–∞—á–∞</h3>
                    <form id="doctorForm">
                        <div class="form-group">
                            <label for="doctorName">–ò–º—è –≤—Ä–∞—á–∞:</label>
                            <input type="text" id="doctorName" class="form-control" required>
                        </div>
                        <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –≤—Ä–∞—á–∞</button>
                    </form>
                </div>

                <div class="card">
                    <h3>–°–ø–∏—Å–æ–∫ –≤—Ä–∞—á–µ–π</h3>
                    <div id="doctorsList">
                        <div class="loading">
                            <div class="spinner"></div>
                            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –≤—Ä–∞—á–µ–π...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- –ü–∞–Ω–µ–ª—å –ª–µ–∫–∞—Ä—Å—Ç–≤ -->
        <div id="medicines" class="tab-content">
            <h2>üíä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –õ–µ–∫–∞—Ä—Å—Ç–≤–∞–º–∏</h2>
            
            <div class="grid">
                <div class="card">
                    <h3>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –ª–µ–∫–∞—Ä—Å—Ç–≤–æ</h3>
                    <form id="medicineForm">
                        <div class="form-group">
                            <label for="medicineName">–ù–∞–∑–≤–∞–Ω–∏–µ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞:</label>
                            <input type="text" id="medicineName" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="medicineUsage">–°–ø–æ—Å–æ–± –ø—Ä–∏–µ–º–∞:</label>
                            <textarea id="medicineUsage" class="form-control" rows="2" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="medicineDescription">–û–ø–∏—Å–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:</label>
                            <textarea id="medicineDescription" class="form-control" rows="3" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="medicineSideEffects">–ü–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã:</label>
                            <textarea id="medicineSideEffects" class="form-control" rows="3" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –ª–µ–∫–∞—Ä—Å—Ç–≤–æ</button>
                    </form>
                </div>

                <div class="card">
                    <h3>–°–ø–∏—Å–æ–∫ –ª–µ–∫–∞—Ä—Å—Ç–≤</h3>
                    <div id="medicinesList">
                        <div class="loading">
                            <div class="spinner"></div>
                            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –ª–µ–∫–∞—Ä—Å—Ç–≤...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å –≤–∏–∑–∏—Ç–æ–≤ -->
        <div id="visits" class="tab-content">
            <h2>üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –í–∏–∑–∏—Ç–∞–º–∏</h2>
            
            <div class="grid">
                <div class="card">
                    <h3>–ó–∞–ø–∏—Å–∞—Ç—å –Ω–æ–≤—ã–π –≤–∏–∑–∏—Ç</h3>
                    <form id="visitForm">
                        <div class="form-group">
                            <label for="visitDate">–î–∞—Ç–∞ –≤–∏–∑–∏—Ç–∞:</label>
                            <input type="date" id="visitDate" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="visitLocation">–ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è:</label>
                            <input type="text" id="visitLocation" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="visitPatient">–ü–∞—Ü–∏–µ–Ω—Ç:</label>
                            <select id="visitPatient" class="form-control" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="visitDoctor">–í—Ä–∞—á:</label>
                            <select id="visitDoctor" class="form-control" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–∞—á–∞</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="visitSymptoms">–°–∏–º–ø—Ç–æ–º—ã:</label>
                            <textarea id="visitSymptoms" class="form-control" rows="3" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="visitDiagnosis">–î–∏–∞–≥–Ω–æ–∑:</label>
                            <input type="text" id="visitDiagnosis" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="visitPrescriptions">–ü—Ä–µ–¥–ø–∏—Å–∞–Ω–∏—è:</label>
                            <textarea id="visitPrescriptions" class="form-control" rows="3" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="visitMedicines" class="optional">–ù–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞:</label>
                            <select id="visitMedicines" class="form-control" multiple>
                            </select>
                            <small>–£–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ Ctrl –¥–ª—è –≤—ã–±–æ—Ä–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ª–µ–∫–∞—Ä—Å—Ç–≤</small>
                        </div>
                        <button type="submit" class="btn btn-primary">–ó–∞–ø–∏—Å–∞—Ç—å –≤–∏–∑–∏—Ç</button>
                    </form>
                </div>

                <div class="card">
                    <h3>–ò—Å—Ç–æ—Ä–∏—è –≤–∏–∑–∏—Ç–æ–≤</h3>
                    <div id="visitsList">
                        <div class="loading">
                            <div class="spinner"></div>
                            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–∑–∏—Ç–æ–≤...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ -->
        <div id="analytics" class="tab-content">
            <h2>üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –û—Ç—á–µ—Ç—ã</h2>
            
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="grid">
                <div class="card">
                    <h3>üìà –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                    <div id="statistics">
                        <div class="loading">
                            <div class="spinner"></div>
                            <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>üèÜ –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –¥–∏–∞–≥–Ω–æ–∑—ã</h3>
                    <div id="popularDiagnoses">
                        <div class="loading">
                            <div class="spinner"></div>
                            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>üíä –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞</h3>
                    <div id="popularMedicines">
                        <div class="loading">
                            <div class="spinner"></div>
                            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ -->
            <div class="grid">
                <div class="card">
                    <h3>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–∑–æ–≤–æ–≤ –ø–æ –¥–∞—Ç–µ</h3>
                    <form id="visitsByDateForm">
                        <div class="form-group">
                            <label for="analyticsDate">–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:</label>
                            <input type="date" id="analyticsDate" class="form-control" required>
                        </div>
                        <button type="submit" class="btn btn-info">–ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ</button>
                    </form>
                    <div id="visitsByDateResult" class="result-box" style="display: none;">
                        <div class="result-number" id="visitsCount">0</div>
                        <div class="result-text">–≤—ã–∑–æ–≤–æ–≤ –≤ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –¥–µ–Ω—å</div>
                    </div>
                </div>

                <div class="card">
                    <h3>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–æ–ª—å–Ω—ã—Ö –ø–æ –±–æ–ª–µ–∑–Ω–∏</h3>
                    <form id="patientsByDiagnosisForm">
                        <div class="form-group">
                            <label for="analyticsDiagnosis">–í–≤–µ–¥–∏—Ç–µ –¥–∏–∞–≥–Ω–æ–∑:</label>
                            <input type="text" id="analyticsDiagnosis" class="form-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ì—Ä–∏–ø–ø" required>
                        </div>
                        <button type="submit" class="btn btn-info">–ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ</button>
                    </form>
                    <div id="patientsByDiagnosisResult" class="result-box" style="display: none;">
                        <div class="result-number" id="patientsCount">0</div>
                        <div class="result-text">–ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ —Å –¥–∞–Ω–Ω—ã–º –¥–∏–∞–≥–Ω–æ–∑–æ–º</div>
                    </div>
                </div>

                <div class="card">
                    <h3>–ü–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –ª–µ–∫–∞—Ä—Å—Ç–≤–∞</h3>
                    <form id="medicineSideEffectsForm">
                        <div class="form-group">
                            <label for="analyticsMedicine">–í—ã–±–µ—Ä–∏—Ç–µ –ª–µ–∫–∞—Ä—Å—Ç–≤–æ:</label>
                            <select id="analyticsMedicine" class="form-control" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ª–µ–∫–∞—Ä—Å—Ç–≤–æ</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-warning">–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã</button>
                    </form>
                    <div id="medicineSideEffectsResult" class="result-box" style="display: none;">
                        <h4 id="medicineNameResult"></h4>
                        <p id="medicineSideEffectsText"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
